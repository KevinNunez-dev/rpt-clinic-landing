---
import TeamCard from '../ui/TeamCard.astro';

const teamMembers = [
  {
    name: "Dr. Dayne Rogers",
    title: "BS, DC, RPT, Medical Director",
    image: "/Dayne.jpg",
    bio: "Dr. Dayne Rogers earned his Bachelor of Science in Nutrition and Doctorate of Chiropractic from Life University in Atlanta, graduating in 1992. With over 30 years treating chronic back pain, herniated discs, and sciatica, he pioneered the integration of robotic precision therapy into comprehensive spinal care."
  },
  {
    name: "Stephanie Burgess",
    title: "CPT, RPT - Movement Specialist",
    image: "/Stephanie.jpg",
    bio: "Stephanie earned her diploma from the National Personal Training Institute of Michigan in 2011. She specializes in corrective exercise and muscular rehabilitation for patients recovering from chronic back pain and structural imbalances."
  },
  {
    name: "Mike Rosenberg",
    title: "PTA, RPT - Rehabilitation Specialist",
    image: "/Mike.jpg",
    bio: "Mike earned his Associate of Applied Science in Physical Therapist Assistant from Macomb Community College and brings nearly 9 years of outpatient orthopedic therapy experience. As a former NCAA Division I lacrosse player, he intimately understands complex injury patterns."
  },
  {
    name: "Monica Simons",
    title: "Patient Care Coordinator",
    image: "/Monica.jpg",
    bio: "Monica brings extensive healthcare coordination experience and a genuine commitment to patient success. She guides patients through their treatment journey from initial consultation through insurance verification and scheduling."
  }
];
---

<section class="team" id="team">
  <h2>Clarkston's Leading Back Pain Specialists</h2>
  <div class="team-grid">
    {teamMembers.map((member) => (
      <TeamCard 
        name={member.name}
        title={member.title}
        image={member.image}
        bio={member.bio}
      />
    ))}
  </div>
</section>

<style>
  .team {
    padding: 100px 2rem;
    max-width: 1400px;
    margin: 0 auto;
    position: relative;
  }

  .team h2 {
    text-align: center;
    font-size: clamp(2.5rem, 5vw, 3.5rem);
    margin-bottom: 4rem;
    background: linear-gradient(135deg, #ffffff 0%, #40c557 50%, #228b22 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    font-weight: 800;
  }

  .team-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 2.5rem;
  }

  @media (max-width: 968px) {
    .team {
      padding: 60px 1rem;
    }

    .team-grid {
      grid-template-columns: 1fr;
    }
  }
</style>

<script>
  // ANIMATION STATE TRACKING - PREVENTS DOUBLE-TRIGGERING
  const animationStates = new Map();

  const observerOptions = {
    threshold: 0.15,
    rootMargin: '0px 0px -50px 0px'
  };

  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      const elementId = entry.target;
      const isVisible = entry.isIntersecting;
      let wasAnimated = animationStates.get(elementId) || false;

      if (isVisible && !wasAnimated) {
        entry.target.classList.add('animate');
        animationStates.set(elementId, true);
      } else if (!isVisible && wasAnimated) {
        entry.target.classList.remove('animate');
        animationStates.set(elementId, false);
      }
    });
  }, observerOptions);

  // Observe team cards
  document.querySelectorAll('.team-card').forEach(card => {
    observer.observe(card);
    animationStates.set(card, false);
  });
</script>
